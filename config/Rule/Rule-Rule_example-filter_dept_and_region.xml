<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Rule PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Rule language="beanshell" name="Rule_Example-Filter_Dept_and_region">
          
    
    <Source><![CDATA[
   import java.util.ArrayList;
import java.util.List;
import sailpoint.api.SailPointContext;
import sailpoint.object.Identity;
import sailpoint.object.QueryOptions;
import sailpoint.tools.GeneralException;
import sailpoint.object.Filter; 
    
    
    
	  ArrayList identityNames=new ArrayList();
	        ArrayList adding =new ArrayList();
	        Filter dpFilter=Filter.eq("department","Finance");
	        Filter wgFilter=Filter.eq("region", "Americas");
	        adding.add(dpFilter);
	        adding.add(wgFilter);
	        Filter finalfilter= Filter.and(adding);

	        QueryOptions qo=new QueryOptions();
	        qo.addFilter(finalfilter);

	        //qo.addFilter(dpFilter);


	        List<Identity>identities=context.getObjects(Identity.class,qo);
	        if(identities!=null && identities.size()>0){


	        for(Identity identity:identities)
	        {
	        System.out.println("Identity:"+identity.getFirstname());
	        System.out.println("Identity:"+identity.getName());

	        identityNames.add(identity.getName());

	        }

	

	    }

		
    ]]></Source>
        

</Rule>
